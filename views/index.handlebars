<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loja de HQs</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/style/styles.css">
</head>

<body>

    <!-- Header -->
 <header class="header bg-dark text-white p-3 d-flex justify-content-between align-items-center">
        <div>
                <img src="/assets/logo.png" alt="Logo" class="logo">
            </a>
        </div>
      <form class="d-flex mx-3" role="search">
    <input class="form-control me-2 border border-light rounded-pill" type="search"
        placeholder="Pesquisar HQs..." aria-label="Pesquisar">
    <button class="btn btn-outline-light rounded-pill" type="submit">Pesquisar</button>
</form>

        <div class="d-flex align-items-center">
            
    <!-- Botão de Carrinho com ícone e contagem de itens -->
    <button class="btn btn-outline-light me-3" data-bs-toggle="modal" data-bs-target="#cartModal" aria-label="Carrinho">
        <i class="bi bi-cart-fill"></i> <!-- Ícone do carrinho -->
        <span id="cartCount" class="badge bg-danger ms-2">0</span> <!-- Contagem de itens no carrinho -->
    </button>

            <!-- Botão de Login com ícone e texto -->
            <button class="btn btn-outline-light me-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                <i class="bi bi-person-fill"></i> Login
            </button>
        </div>
    </header>

    <!-- Carrossel de Imagens -->
    <div id="carouselImages" class="carousel slide" data-bs-ride="carousel" data-bs-interval="2500">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="assets/banner1.png" class="d-block w-100" alt="Banner 1">
            </div>
            <div class="carousel-item">
                <img src="assets/banner2.jpg" class="d-block w-100" alt="Banner 2">
            </div>
            <div class="carousel-item">
                <img src="assets/banner3.jpg" class="d-block w-100" alt="Banner 3">
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselImages" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselImages" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>


<div class="container my-5">
    <h2 class="text-center">Destaques</h2>
    <div class="row mt-4 justify-content-start">
        {{#if revistas.length}}
            {{#each revistas}}
            <div class="col-md-4 mb-4">
                <div class="card hq-card">
                    <img src="{{this.imagem}}" class="card-img-top" alt="{{this.titulo}}">
                    <div class="card-body">
                        <h5 class="card-title">{{this.titulo}}</h5>
                        <p class="card-text">{{this.descricao}}</p>
                        <p class="card-price">R$ {{this.preco}}</p>
                          <button class="btn btn-primary w-100 add-to-cart" data-id="{{this.id}}"
                            data-titulo="{{this.titulo}}" data-preco="{{this.preco}}">
                            <i class="bi bi-cart-plus"></i> Adicionar ao Carrinho
                        </button>
                    </div>
                </div>
            </div>
            {{/each}}
        {{else}}
            <p class="text-center">Nenhuma revista encontrada.</p>
        {{/if}}
    </div>
</div>

    <!-- Carrossel de GIFs -->
    <div id="carouselGifs" class="carousel slide" data-bs-ride="carousel" data-bs-interval="1000">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://i.giphy.com/media/vBjLa5DQwwxbi/giphy.gif" class="d-block w-100" alt="GIF 1">
            </div>
            <div class="carousel-item">
                <img src="https://i.giphy.com/media/VXQuKHDhTIBWM/giphy.gif" class="d-block w-100" alt="GIF 2">
            </div>
            <div class="carousel-item">
                <img src="https://i.giphy.com/media/IgtOuXZ6dnuTu/giphy.gif" class="d-block w-100" alt="GIF 3">
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselGifs" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselGifs" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>

    <!-- Seção de HQs 2 -->
    <div class="container my-5">
        <h2 class="text-center">Marvel</h2>
        <div class="row mt-4 justify-content-start offset-md-1">
            <!-- Card de HQ -->
            <div class="col-md-4 mb-4">
                <div class="card hq-card">
                    <img src="assets/hq4.jpg" class="card-img-top" alt="HQ 1">
                    <div class="card-body">
                        <h5 class="card-title">Feiticeira Escarlate (2024) Vol. 1</h5>
                       <p class="card-text">Há uma porta que se revela apenas para aqueles que estão desesperados.
                            Ela surge no momento de maior necessidade, oferecendo uma chance de redenção
                            ou transformação, mas a um preço"</p>
                        <p class="card-price">R$ 29,90</p>
                          <button class="btn btn-primary w-100 add-to-cart" 
                    data-id="hq4" 
                    data-titulo="Feiticeira Escarlate (2024) Vol. 1" 
                    data-preco="29.90">
                <i class="bi bi-cart-plus"></i> Adicionar ao Carrinho
            </button>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card hq-card">
                    <img src="assets/hq5.jpg" class="card-img-top" alt="HQ 2">
                    <div class="card-body">
                        <h5 class="card-title">Desafio Infinito (Marvel Essenciais)</h5>
                        <p class="card-text">Na tentativa de atender aos desígnios de sua amada senhora, a Morte, Thanos
                            traça um grandioso estratagema para subjugar as misteriosas entidades cósmicas.
                            para invadir o mundo e uhu!</p>
                        <p class="card-price">R$ 34,90</p>
                         <button class="btn btn-primary w-100 add-to-cart" 
                    data-id="hq5" 
                    data-titulo="Desafio Infinito (Marvel Essenciais)" 
                    data-preco="34.90">
                <i class="bi bi-cart-plus"></i> Adicionar ao Carrinho
            </button>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card hq-card">
                    <img src="assets/hq3.png" class="card-img-top" alt="HQ 3">
                    <div class="card-body">
                        <h5 class="card-title">Marvel-Verse: Aranhaverso</h5>
                        <p class="card-text">Adentre o Aranhaverso ao lado de um montão de heróis-aranha! Com sua
                            capacidade de atravessar o Multiverso, o Homem-Aranha forma uma equipe especial para
                            localizar uma ponta solta</p>
                        <p class="card-price">R$ 39,90</p>
                         <button class="btn btn-primary w-100 add-to-cart" 
                    data-id="hq3" 
                    data-titulo="Marvel-Verse: Aranhaverso" 
                    data-preco="39.90">
                <i class="bi bi-cart-plus"></i> Adicionar ao Carrinho
            </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Seção de HQs 3 -->
    <div class="container my-5">
        <h2 class="text-center">DC</h2>
        <div class="row mt-4 justify-content-start offset-md-1">
            <!-- Card de HQ -->
            <div class="col-md-4 mb-4">
                <div class="card hq-card">
                    <img src="assets/hq7.jpeg" class="card-img-top" alt="HQ 1">
                    <div class="card-body">
                        <h5 class="card-title">Jovens Titãs nº 17 (Universo DC)</h5>
                        <p class="card-text">Com a destruição da Torre Titã, a equipe precisa seguir em frente e
                            encontrar uma nova base de operações, mas essa é a menor de suas preocupações. </p>
                        <p class="card-price">R$ 19,90</p>
                        <button class="btn btn-primary w-100 add-to-cart" 
                    data-id="hq7" 
                    data-titulo="Jovens Titãs nº 17 (Universo DC)" 
                    data-preco="19.90">
                <i class="bi bi-cart-plus"></i> Adicionar ao Carrinho
            </button>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card hq-card">
                    <img src="assets/hq8.jpg" class="card-img-top" alt="HQ 2">
                    <div class="card-body">
                        <h5 class="card-title">Liga da Justiça. Origem.</h5>
                        <p class="card-text">Super-heróis – como Superman em Metrópolis e o misterioso Batman de Gotham
                            – são novos e assustadores para o mundo inteiro. </p>
                        <p class="card-price">R$ 34,90</p>
                         <button class="btn btn-primary w-100 add-to-cart" 
                    data-id="hq8" 
                    data-titulo="Liga da Justiça. Origem." 
                    data-preco="34.90">
                <i class="bi bi-cart-plus"></i> Adicionar ao Carrinho
            </button>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card hq-card">
                    <img src="assets/hq10.jpg" class="card-img-top" alt="HQ 3">
                    <div class="card-body">
                        <h5 class="card-title">Asa Noturna (2022) Vol. 3</h5>
                        <p class="card-text">Dick Grayson retorna a Blüdhaven após os eventos de Estado de Medo, apenas
                            para descobrir que uma recompensa de US$ 10.000.000 </p>
                        <p class="card-price">R$ 39,90</p>
                          <button class="btn btn-primary w-100 add-to-cart" 
                    data-id="hq10" 
                    data-titulo="Asa Noturna (2022) Vol. 3" 
                    data-preco="39.90">
                <i class="bi bi-cart-plus"></i> Adicionar ao Carrinho
            </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Login -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">Login</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" placeholder="Digite seu email">
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Senha</label>
                            <input type="password" class="form-control" id="password" placeholder="Digite sua senha">
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Entrar</button>
                    </form>
                    <div id="error-message" class="text-danger mt-2" style="display: none;">
                        <p>Email ou senha incorretos. Tente novamente.</p>
                    </div>
                    <div class="text-center mt-3">
                        <p>Não tem uma conta? <a href="/cadastro">Cadastre-se</a></p>
                    </div>
                </div>
            </div>
        </div>

       <!-- Modal de Carrinho -->
<div class="modal fade" id="cartModal" tabindex="-1" aria-labelledby="cartModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="cartModalLabel">Carrinho de Compras</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="emptyCartMessage" class="text-center" style="display: none;">Carrinho Vazio</div>
                <div id="cartItems" class="cart-items">
                    <!-- Os itens serão injetados aqui -->
                </div>
                <hr>
                <div id="cartSummary" class="cart-summary d-flex justify-content-between">
                    <h5>Total</h5>
                    <h5 id="cartTotal">R$ 0,00</h5>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="continueShopping">Continuar Comprando</button>
                <button type="button" class="btn btn-primary" id="finalizePurchase">Finalizar Compra</button>
            </div>
        </div>
    </div>
</div>

        <!-- Footer -->
        <footer class="footer bg-dark text-white text-center p-4">
            <div class="footer-logo">
                <img src="assets/logo.png" alt="Logo Loja de HQs" class="footer-logo-img mb-3">
            </div>
            <p>&copy; 2024 Loja de HQs. Todos os direitos reservados.</p>
            <p>
                <a href="#" class="text-white me-3">Política de Privacidade</a>
                <a href="#" class="text-white">Termos de Uso</a>
            </p>
            <div class="social-icons">
                <a href="https://facebook.com" class="text-white me-3" target="_blank">
                    <i class="bi bi-facebook"></i> Facebook
                </a>
                <a href="https://twitter.com" class="text-white me-3" target="_blank">
                    <i class="bi bi-twitter"></i> Twitter
                </a>
                <a href="https://instagram.com" class="text-white" target="_blank">
                    <i class="bi bi-instagram"></i> Instagram
                </a>
            </div>
        </footer>

        <script>
            document.getElementById('loginForm').addEventListener('submit', async function (event) {
                event.preventDefault(); // Impede o envio do formulário

                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;

                // Credenciais fixas para o painel de admin
                const adminEmail = "admin@admin.com";
                const adminPassword = "123";

                // Verifica se as credenciais correspondem às fixas
                if (email === adminEmail && password === adminPassword) {
                    // Redireciona para a página de administração
                    window.location.href = "/colecao-hqs";
                } else {
                    try {
                        const response = await fetch('/login', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ email, password })
                        });

                        if (response.ok) {
                            // Se o login foi bem-sucedido, redireciona para a página apropriada
                            window.location.href = "/homeUser";
                        } else {
                            document.getElementById('error-message').style.display = 'block';
                        }
                    } catch (error) {
                        console.error("Erro ao tentar fazer login:", error);
                        document.getElementById('error-message').style.display = 'block';
                    }
                }
            });
        </script>
<script>
    // Função para filtrar as HQs com base no termo de pesquisa
    function pesquisarHQs() {
        const termoPesquisa = document.querySelector('input[type="search"]').value.toLowerCase(); // Pega o valor da pesquisa
        const hqs = document.querySelectorAll('.hq-card'); // Seleciona todos os cards de HQ

        // Verifica se o campo de pesquisa está vazio
        if (termoPesquisa === "") {
            hqs.forEach(function (hq) {
                hq.style.display = 'block'; // Mostra todas as HQs se o campo estiver vazio
            });
        } else {
            // Caso contrário, faz a filtragem
            hqs.forEach(function (hq) {
                const tituloHQ = hq.querySelector('.card-title').textContent.toLowerCase(); // Pega o título da HQ

                // Se o título da HQ contém o termo de pesquisa, mostra o card, caso contrário, oculta
                if (tituloHQ.includes(termoPesquisa)) {
                    hq.style.display = 'block';
                } else {
                    hq.style.display = 'none';
                }
            });
        }
    }

    // Adiciona o evento para filtrar as HQs ao digitar no campo de pesquisa
    document.querySelector('input[type="search"]').addEventListener('input', pesquisarHQs);

    // Adiciona o evento para clicar no botão de pesquisa
    document.querySelector('form[role="search"]').addEventListener('submit', function(event) {
        event.preventDefault(); // Impede o envio do formulário
        pesquisarHQs(); // Chama a função para filtrar as HQs
    });
</script>

<script>
    // Adiciona um carrinho de compras vazio
    let cart = [];

    // Função para atualizar a exibição do carrinho
    function updateCart() {
        const cartCount = document.getElementById('cartCount');
        const emptyCartMessage = document.getElementById('emptyCartMessage');
        const cartSummary = document.getElementById('cartSummary');
        const cartItems = document.getElementById('cartItems');
        const cartTotal = document.getElementById('cartTotal');

        // Atualiza o estado do carrinho
        if (cart.length === 0) {
            cartCount.textContent = '0';
            emptyCartMessage.style.display = 'block';
            cartSummary.style.display = 'none';
        } else {
            cartCount.textContent = cart.length;
            emptyCartMessage.style.display = 'none';
            cartSummary.style.display = 'block';
        }

        // Limpa os itens exibidos no modal e recalcula o total
        let total = 0;
        cartItems.innerHTML = '';

        // Exibe os itens no modal
        cart.forEach(item => {
            total += item.preco;
            cartItems.innerHTML += `
                <div class="cart-item d-flex justify-content-between align-items-center mb-3">
                    <div class="cart-item-details">
                        <h6>${item.titulo}</h6>
                        <p>Preço: R$ ${item.preco.toFixed(2)}</p>
                    </div>
                    <button class="btn btn-sm btn-danger" onclick="removeItemFromCart('${item.id}')">Remover</button>
                </div>
            `;
        });

        // Atualiza o total no modal
        cartTotal.textContent = `R$ ${total.toFixed(2)}`;
    }

    // Função para adicionar um item ao carrinho
    function addItemToCart(id, titulo, preco) {
        cart.push({ id, titulo, preco });
        updateCart();
        alert('Item adicionado ao carrinho com sucesso!');
    }

    // Função para remover um item do carrinho
    function removeItemFromCart(id) {
        cart = cart.filter(item => item.id !== id);
        updateCart();
    }

    // Ação do botão de "Continuar Comprando"
    document.getElementById('continueShopping').addEventListener('click', function () {
        location.reload(); // Redireciona para a tela inicial (recarrega a página)
    });

    // Finalizar compra
    document.getElementById('finalizePurchase').addEventListener('click', function () {
        alert('Compra finalizada com sucesso!');
        location.reload(); // Redireciona para a tela inicial (recarrega a página)
    });

    // Atualizar o carrinho ao abrir o modal
    document.getElementById('cartModal').addEventListener('shown.bs.modal', function () {
        updateCart();
    });

    // Adicionar item ao carrinho ao clicar no botão
    document.querySelectorAll('.add-to-cart').forEach(button => {
        button.addEventListener('click', function () {
            const id = this.getAttribute('data-id');
            const titulo = this.getAttribute('data-titulo');
            const preco = parseFloat(this.getAttribute('data-preco'));
            addItemToCart(id, titulo, preco);
        });
    });
</script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    </div>
</body>

</html>